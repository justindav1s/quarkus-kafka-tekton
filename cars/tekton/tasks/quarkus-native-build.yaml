apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: quarkus-native-build
spec:
  workspaces:
    - name: shared-workspace
    - name: maven-settings
    - name: truststore
  params:
    - name: APP_NAME
      type: string
  steps:
    - name: apply
      image: quay.io/justindav1s/quarkus-native-builder:latest
      workingDir: /workspace/shared-workspace/$(params.APP_NAME)
      command: ["/bin/bash", "-c"]
      args:
        - |-
          echo -----------Build------------------------
          mvn -U -B -s tekton/settings.xml '-DskipTests' '-Dnative'  '-Dquarkus.package.type=native' 'clean' 'package'
          echo -------------DONE-------------------